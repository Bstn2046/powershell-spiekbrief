<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PowerShell RoC — Snel</title>
<style>
  body{font-family:Inter,system-ui,Arial;margin:0;background:#0b1220;color:#e6eef6;padding:24px}
  .wrap{max-width:1000px;margin:0 auto}
  header{display:flex;align-items:center;justify-content:space-between}
  h1{margin:0 0 8px 0}
  .muted{color:#9aa7b2;font-size:14px}
  .grid{display:grid;grid-template-columns:1fr 320px;gap:18px;margin-top:18px}
  .card{background:rgba(255,255,255,0.02);padding:16px;border-radius:12px}
  pre{background:#071022;padding:12px;border-radius:8px;overflow:auto}
  .search-sites button{display:block;width:100%;margin-bottom:8px;padding:8px;border-radius:8px;border:none;background:#0b3a44;color:#e6eef6}
  .links a{color:#06b6d4}
  @media(max-width:900px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>PowerShell RoC</h1>
        <div class="muted">Snelle voorbeelden, veelgebruikte cmdlets en gerichte zoekknoppen</div>
      </div>
      <div class="muted">Gemaakt voor snel referentie</div>
    </header>

    <div class="grid">
      <main>
        <section class="card">
          <h2>Essentials</h2>
          <div class="muted">Objecten, pipeline en basis-syntaxis</div>
          <pre><code># Pipeline: stuur output naar volgende cmdlet
Get-Process | Where-Object {$_.CPU -gt 100} | Sort-Object CPU -Descending

# Veelgebruikte cmdlets
Get-Help Get-Process
Get-Command -Name *Service*
Get-ChildItem -Path C:\ -Recurse
Get-Content .\file.txt | Select-String 'error'

# Functie voorbeeld
function Greet($name){
  "Hallo, $name"
}

# Variabelen en arrays
$a = 1
$list = 1,2,3
$list | ForEach-Object { $_ * 2 }
</code></pre>

          <h3>Snelle tips</h3>
          <ul>
            <li>Gebruik <code>Get-Help</code> (vergeet <code>Update-Help</code> niet).</li>
            <li>Cmdlets volgen <em>Werkwoord-Zaaknomen</em> patroon (Get-Process, Set-Item).</li>
            <li>Gebruik <code>Where-Object</code> en <code>ForEach-Object</code> voor pipeline-manipulatie.</li>
          </ul>
        </section>

        <section class="card" style="margin-top:12px">
          <h2>Veelgebruikte cmdlets (kort)</h2>
          <pre><code>Get-Help, Get-Command, Get-ChildItem, Get-Content, Set-Content, Add-Content,
Get-Process, Stop-Process, Get-Service, Start-Service, Stop-Service,
Get-EventLog, Get-Event, Get-WmiObject / Get-CimInstance,
Import-Module, Install-Module, Connect-* (Graph/Exchange/Teams modules)</code></pre>
        </section>

        <section class="card" style="margin-top:12px">
          <h2>Voorbeeld: bestanden zoeken en rapport maken</h2>
          <pre><code>Get-ChildItem -Path C:\Logs -Recurse -Filter *.log |
  Select-Object FullName, Length, LastWriteTime |
  Export-Csv -Path C:\temp\log-report.csv -NoTypeInformation</code></pre>
        </section>
        <section class="card" style="margin-top:12px">
  <h2>Active Directory PowerShell</h2>
  <div class="muted">Cmdlets voor beheer van gebruikers, groepen, computers en OU's</div>

  <h3>Basis-cmdlets</h3>
  <pre><code># Gebruiker zoeken
Get-ADUser -Identity jansenp
Get-ADUser -Filter "Name -like '*Piet*'" | Select Name, SamAccountName, Enabled

# Nieuwe gebruiker aanmaken
New-ADUser -Name "Test Gebruiker" -SamAccountName tgebruiker -AccountPassword (Read-Host -AsSecureString "Voer wachtwoord in") -Enabled $true -Path "OU=Gebruikers,DC=school,DC=local"

# Gebruiker uitschakelen of verwijderen
Disable-ADAccount -Identity tgebruiker
Remove-ADUser -Identity tgebruiker

# Lidmaatschap bekijken
Get-ADUser -Identity jansenp -Properties MemberOf | Select-Object -ExpandProperty MemberOf

# Groepen beheren
Get-ADGroup -Filter * | Select Name
Add-ADGroupMember -Identity "ICT-Beheer" -Members jansenp
Remove-ADGroupMember -Identity "ICT-Beheer" -Members jansenp

# Computers beheren
Get-ADComputer -Filter * | Select Name, LastLogonDate
Disable-ADAccount -Identity PC-1234

# OU's
Get-ADOrganizationalUnit -Filter * | Select Name, DistinguishedName
</code></pre>

  <h3>Rapportage en filters</h3>
  <pre><code># Inactieve gebruikers (bijv. 90 dagen)
Search-ADAccount -AccountInactive -UsersOnly -TimeSpan 90.00:00:00 | 
  Select Name, LastLogonDate |
  Export-Csv C:\Rapporten\InactiveUsers.csv -NoTypeInformation

# Alle leden van een groep
Get-ADGroupMember -Identity "ICT-Beheer" | 
  Select Name, SamAccountName | 
  Export-Csv C:\Rapporten\ICTBeheerLeden.csv -NoTypeInformation
</code></pre>

  <ul>
    <li>Module: <code>Import-Module ActiveDirectory</code> (standaard aanwezig op domain controllers)</li>
    <li>Gebruik <code>-Properties *</code> om alle AD-attributen te zien.</li>
    <li>Voor grote queries gebruik <code>-SearchBase</code> en <code>-SearchScope</code> om de OU te beperken.</li>
    <li>Je kunt AD-data eenvoudig exporteren naar CSV voor rapportage of migraties.</li>
  </ul>
</section>

<section class="card" style="margin-top:12px">
  <h2>CSV-bestanden in PowerShell</h2>
  <div class="muted">CSV = “Comma Separated Values” — ideaal voor import/export en rapporten</div>

  <h3>Lezen en schrijven</h3>
  <pre><code># Exporteren naar CSV
Get-Service | Select Name, Status, StartType |
  Export-Csv -Path C:\temp\Services.csv -NoTypeInformation

# Inlezen van CSV
$users = Import-Csv -Path C:\temp\users.csv
$users | ForEach-Object { "Gebruiker: $($_.Name)" }

# Voorbeeldbestand users.csv
# Name,SamAccountName,OU,Password
# Piet Jansen,pjansen,OU=Gebruikers,DC=school,DC=local,P@ssw0rd!
</code></pre>

  <h3>CSV gebruiken voor AD-acties</h3>
  <pre><code># Gebruikers importeren uit CSV
Import-Csv C:\temp\users.csv | ForEach-Object {
  New-ADUser -Name $_.Name -SamAccountName $_.SamAccountName `
    -Path $_.OU -AccountPassword (ConvertTo-SecureString $_.Password -AsPlainText -Force) `
    -Enabled $true
}

# Wachtwoorden resetten vanuit CSV
Import-Csv C:\temp\reset.csv | ForEach-Object {
  Set-ADAccountPassword -Identity $_.SamAccountName -NewPassword (ConvertTo-SecureString $_.Password -AsPlainText -Force) -Reset
}

# Export van gebruikers naar CSV
Get-ADUser -Filter * -Properties Department,Title |
  Select Name,SamAccountName,Department,Title |
  Export-Csv C:\temp\ADUsers.csv -NoTypeInformation
</code></pre>

  <h3>Tips</h3>
  <ul>
    <li>Gebruik <code>-NoTypeInformation</code> om onnodige metadata te verwijderen.</li>
    <li>Gebruik <code>Import-Csv</code> voor batch-creatie of -aanpassingen.</li>
    <li>Gebruik <code>Export-Csv</code> voor rapportage of overdracht naar Excel.</li>
    <li>Combineer met AD-cmdlets voor krachtige automatisering (gebruikersbeheer, logging, inventarisatie).</li>
  </ul>
</section>
      </main>

      <aside>
        <div class="card">
          <h3>Gerichte zoeken</h3>
          <p class="muted">Typ je zoekterm en kies een site om gericht te zoeken.</p>
          <input id="q" placeholder="zoekterm (bijv. Get-ADUser)" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;margin-bottom:8px">
          <div class="search-sites">
            <button onclick="searchSite('microsoft')">Zoek Microsoft Docs</button>
            <button onclick="searchSite('ss64')">Zoek SS64 (cmdlet index)</button>
            <button onclick="searchSite('sans')">Zoek SANS cheat sheet (PDF)</button>
            <button onclick="searchSite('practical')">Zoek Practical PowerShell (quick ref)</button>
            <button onclick="searchSite('ninjaone')">Zoek NinjaOne cheat sheet</button>
            <button onclick="searchSite('all')">Zoek overal (Google)</button>
          </div>

          <h4 style="margin-top:12px">Snelkoppelingen (handig)</h4>
          <div class="links">
            <div><a href="https://learn.microsoft.com/powershell/">Microsoft PowerShell docs</a></div>
            <div><a href="https://ss64.com/ps/">SS64 PowerShell command index</a></div>
            <div><a href="https://cdn.comparitech.com/wp-content/uploads/2018/08/Comparitech-Powershell-cheatsheet.pdf">Comparitech cheat sheet (PDF)</a></div>
            <div><a href="https://practicalpowershell.com/wp-content/uploads/2020/04/PowerShellQuickReference-PowerShell7.0-v1.03.pdf">Practical PowerShell quick reference (PDF)</a></div>
            <div><a href="https://www.ninjaone.com/blog/windows-powershell-commands-cheat-sheet/">NinjaOne commands cheat sheet</a></div>
          </div>

          <script>
            function searchSite(site){
              const q = encodeURIComponent(document.getElementById('q').value.trim() || 'PowerShell');
              let url = '';
              switch(site){
                case 'microsoft': url = `https://www.google.com/search?q=site:learn.microsoft.com+${q}`; break;
                case 'ss64': url = `https://www.google.com/search?q=site:ss64.com+${q}`; break;
                case 'sans': url = `https://www.google.com/search?q=site:cdn.comparitech.com+${q}`; break;
                case 'practical': url = `https://www.google.com/search?q=site:practicalpowershell.com+${q}`; break;
                case 'ninjaone': url = `https://www.google.com/search?q=site:ninjaone.com+${q}`; break;
                default: url = `https://www.google.com/search?q=${q}+PowerShell`;
              }
              window.open(url,'_blank');
            }
          </script>
        </div>

        <div class="card" style="margin-top:12px">
          <h3>Bronnen (curatie)</h3>
          <div class="muted">Deze informatie verwijst naar gezaghebbende docs en handige quick refs.</div>
          <ul>
            <li>Microsoft Docs — officiële referentie en cmdlet documentatie</li>
            <li>SS64 — A–Z index van veelgebruikte commands</li>
            <li>SANS / Practical refs — handzame PDF cheat sheets</li>
            <li>NinjaOne / blogs — praktische voorbeelden en tips</li>
          </ul>
        </div>
      </aside>
    </div>

    <footer style="margin-top:18px;color:#9aa7b2">Made for quick reference • Pas naar wens aan</footer>
  </div>
</body>

</html>

